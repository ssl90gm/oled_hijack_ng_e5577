Huawei OLED hijacking library E5577Cs-321
=============================

This library adds advanced menu to the OLED display of Huawei E5785 portable LTE router.  
This is achieved by hijacking certain library calls in the "oled" executable file.

The menu can be activated with long menu key press.

![Menu 1](https://i.imgur.com/5S8vXyV.png)
![Signal 1](https://i.imgur.com/OFwKXiG.png)
![Signal 2](https://i.imgur.com/or7uaIQ.png)
![USSD](https://i.imgur.com/r7jMkhF.png)
![Sms 1](https://i.imgur.com/uf6ZMB9.png)
![Sms 2](https://i.imgur.com/Y3bpAD6.png)
![Menu 2](https://i.imgur.com/WHYpMrk.png)
![SSH](https://i.imgur.com/T5CxgVu.png)
![ADBD](https://i.imgur.com/dJDRfIw.png)
![VPN](https://i.imgur.com/8AdwUPl.png)
![Snake](https://i.imgur.com/SmzjVw6.png)
![Matrix](https://i.imgur.com/arRx9Ve.png)


## How does it work
This library hijacks `register_notify_handler()`, `lcd_refresh_screen()` and `lcd_control_operate()`.

`register_notify_handler()` registers it's own proxy handler which intercepts key press events. If it detects long menu key press, it switches to
the "secret menu" mode. In this mode the lcd_refresh_screen outputs the custom lcd buffer and input events are going to the our handlers. 
Also the brightness of the display is controlled by us by hijacking lcd_control_operate().

Very simple, yet effective.

## Differences between huawei_oled_hijack_ng and huawei_oled_hijack

This project was inspired by the amazing [huawei_oled_hijack](https://github.com/ValdikSS/huawei_oled_hijack) project.

The key difference is that instead of patching `sprintf` function to change the internal buffers and insert new items to
the menu generated by oled library, this project draws the menu from scratch. This gives these advantages:

- Support of 32768 colors instead of 2 colors
- Support for making custom interfaces. No more wasting space in the top and bottom
- The redisigned architecture, that based on timers. The absense of blocking calls
- Better portability. No more need for hardcode addresses of global variables for every oled build.


**Contributions are welcome**.
# Forked oled_hijack_ng E5577
